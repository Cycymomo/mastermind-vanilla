/*! mastermind-vanilla v0.0.1 | Cyril Moreau -@cycymomo | MIT License | http://nickdouille.github.io/mastermind-vanilla/dist/ */

!function(e){"use strict";if(!e.document)throw"The game must be launched in the browser (DOM API required)";var t,n,o,l,i,c,r,s,u,a,d,f,m,p,h,g,y,C,b,E,v,B,I;v=10,B=4,I=["#f00","#0f0","#00f","#ff0","#fff","#bbb","#f80","#f0f"],m=[],p=e.localStorage&&e.localStorage.str_gridCouleursTentees?JSON.parse(e.localStorage.str_gridCouleursTentees):[],h=[],y=e.document.getElementById("couleursATrouver"),C=e.document.getElementById("couleursTentees"),b=e.document.getElementById("couleursAChoisir"),E=e.document.getElementById("palette"),l=function w(){var e=Math.floor(Math.random()*I.length);return-1===m.indexOf(e)?e:w()},i=function(){y.style.display=y.style.display&&"none"!==y.style.display?"none":"block"},c=function(t){var n,o;if(!(t.target instanceof e.HTMLSpanElement))throw"[fn_openPalette] Cette fonction ne peut pas être appelée ici";if(n=+t.target.id.split("_")[1],o=e.document.getElementById("couleursAChoisir_"+n),!o)throw"Impossible de sélectionner cette case";E.style.display="block",g=n},r=function(){E.style.display="none",g=null},s=function(){var t,n=e.document.getElementById("couleursAChoisir_"+g);if(!(this instanceof e.HTMLSpanElement))throw"[fn_selectColor] Cette fonction ne peut pas être appelée ici";if(!n)throw"Choisir d'abord une case";if(t=+this.id.split("_")[1],!I[t])throw"Cette couleur n'existe pas";if(-1!==h.indexOf(t)&&h[g]!==t)throw"Impossible de sélectionner deux couleurs identiques";h[g]=t,n.style.backgroundColor=I[t],r(),h.join("").length===B&&(e.document.getElementById("validChoice").style.visibility="visible")},a=function(){h=[];for(var t=0;B>t;t++)e.document.getElementById("couleursAChoisir_"+t).style.backgroundColor="#fff"},u=function(){var t,n,l,i=p.length;for(p.push(h.slice()),e.document.getElementById("validChoice").style.visibility="hidden",t=0,n=h.length;n>t;t++)o(C,i+"."+t,I[h[t]]);l=e.document.createElement("span"),l.id=i+".nbBlanc",l.className="rowResultBlanc",C.appendChild(l),l=e.document.createElement("span"),l.id=i+".nbRouge",l.className="rowResultRouge",C.appendChild(l),d(i),a()},d=function(t){var n=h.join(""),o=m.join(""),l=e.document.getElementById(t+".nbBlanc"),i=e.document.getElementById(t+".nbRouge"),c=0,r=0;if(!l||!i)throw"Impossible d'afficher le résultat";n===o?f(!0,t+1):t+1===v?f():(h.forEach(function(e,t){e===m[t]?r++:-1!==m.indexOf(e)&&c++}),l.innerHTML=c,i.innerHTML=r)},f=function(t,n){e.alert(t?"Gagné en "+n+" coups !":"Perdu"),e.location.reload()},o=function(t,n,o,l){var i;i=e.document.createElement("span"),i.id=n,i.style.backgroundColor=o,l&&(i.onclick=l),t.appendChild(i)},n=function(){var t,n,l,i,c;for(l=0,c=p.length;c>l;l++){for(n=e.document.createElement("div"),n.id=l,i=0;B>i;i++)o(n,l+"."+i,p[l][i]);t=e.document.createElement("span"),t.id=l+".nbBlanc",t.className="rowResultBlanc",n.appendChild(t),t=e.document.createElement("span"),t.id=l+".nbRouge",t.className="rowResultRouge",n.appendChild(t),C.appendChild(n)}},t=function(){var e,t;for(e=0;e<I.length;e++)o(E,"palette_"+e,I[e],s);for(e=0;B>e;e++)t=l(),m.push(t),o(y,"couleursATrouver_"+e,I[t]),o(b,"couleursAChoisir_"+e,"#fff",c);n()},t(),e.document.getElementById("toggleSolution").onclick=i,e.document.getElementById("validChoice").onclick=u}(this);
